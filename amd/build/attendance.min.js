define(['jquery','report_categoryreports/jszip','report_categoryreports/pdfmake','report_categoryreports/jquery.dataTables','report_categoryreports/dataTables.buttons','report_categoryreports/buttons.html5','report_categoryreports/buttons.flash','report_categoryreports/buttons.print','report_categoryreports/bootstrap','report_categoryreports/sweetalert'],function(a){return{init:function init(){var l=this;a('.program_select').on('change',{self:l},function(){l.load_courses(l,a(this))}),a('#btn_filter_attendance').on('click',{self:l},function(){l.get_attendance(l,a('#course_select').val())}),a('#btn_filter_grades').on('click',{self:l},function(){l.get_grades(l,a('#course_select_grader').val())})},load_courses:function load_courses(l,m){var n={'function':'get_courses',id_category:m.val()};a.ajax({type:'POST',data:n,url:'../managers/attendance_server_proc.php',success:function success(o){var p='';if(a('.course_select').html(''),0<Object.keys(o).length){for(var q in o)p+='<option value=\''+o[q].id+'\'>'+o[q].shortname+'</option>';a('.course_select').append(p)}else a('.course_select').append('<option value=\'\'><i>No registra cursos</i></option>')},dataType:'json',cache:'false',error:function error(o){console.log(o)}})},get_attendance:function get_attendance(l,m){a.ajax({type:'POST',data:{'function':'get_attendance',courseid:m},url:'../managers/attendance_server_proc.php',success:function success(o){a('#div_table').html(''),a('#div_table').fadeIn(1e3).append('<table id="table_attendance" class="display" cellspacing="0" width="100%"></table>'),a('#table_attendance').DataTable(o.table),a('#div_course_title_attendance').html(''),a('#div_course_title_attendance').append('<a href="/moodle/course/view.php?id='+m+'"><h4>'+o.course_fullname+'</h4></a>')},dataType:'json',cache:'false',error:function error(o){console.log(o)}})},get_grades:function get_grades(l,m){a.ajax({type:'POST',data:{'function':'get_grader',courseid:m},url:'../managers/grades_api.php',success:function success(o){a('#div_grader').html(''),a('#div_grader').fadeIn(1e3).append('<table id="table_grader" class="display" cellspacing="0" width="100%"></table>'),a('#table_grader').DataTable(o.table),a('#div_course_title_grades').html(''),a('#div_course_title_grades').append('<a href="/moodle/course/view.php?id='+m+'"><h4>'+o.course_fullname+'</h4></a>')},dataType:'json',cache:'false',error:function error(o){console.log(o)}})}}});